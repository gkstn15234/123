<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오토데일리 기사 에디터</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="style.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-dark bg-primary">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="fas fa-edit"></i> 오토데일리 기사 에디터
            </span>
            <div>
                <button class="btn btn-outline-light me-2" id="aiWriteBtn">
                    <i class="fas fa-robot"></i> AI 글작성
                </button>
                <button class="btn btn-outline-light me-2" id="downloadBtn">
                    <i class="fas fa-download"></i> 다운로드
                </button>
                <button class="btn btn-outline-light" id="uploadBtn">
                    <i class="fab fa-github"></i> GitHub 업로드
                </button>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-3">
        <div class="row">
            <!-- 좌측: 입력 폼 -->
            <div class="col-lg-6">
                <!-- 메타데이터 입력 -->
                <div class="card mb-3">
                    <div class="card-header">
                        <h5><i class="fas fa-info-circle"></i> 기사 정보</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-8">
                                <label for="title" class="form-label">제목 *</label>
                                <input type="text" class="form-control" id="title" placeholder="기사 제목을 입력하세요">
                            </div>
                            <div class="col-md-4">
                                <label for="category" class="form-label">카테고리 *</label>
                                <select class="form-select" id="category">
                                    <option value="automotive">자동차</option>
                                    <option value="economy">경제</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="author" class="form-label">작성자 *</label>
                                <select class="form-select" id="author">
                                    <option value="오은진">오은진</option>
                                    <option value="기타">기타</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="publishDate" class="form-label">발행일시 *</label>
                                <input type="datetime-local" class="form-control" id="publishDate">
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="description" class="form-label">기사 요약 *</label>
                            <textarea class="form-control" id="description" rows="3" 
                                      placeholder="기사 요약을 입력하세요 (150자 이내)" maxlength="150"></textarea>
                            <div class="form-text">
                                <span id="descLength">0</span>/150자
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="tags" class="form-label">태그</label>
                            <input type="text" class="form-control" id="tags" 
                                   placeholder="태그를 쉼표로 구분하여 입력 (예: 현대차, 전기차, 신차)">
                            <div class="form-text">최대 5개까지 입력 가능</div>
                        </div>
                    </div>
                </div>

                <!-- 이미지 업로드 (로컬) -->
                <div class="card mb-3">
                    <div class="card-header">
                        <h5><i class="fas fa-image"></i> 기사 이미지 (최대 4개)</h5>
                        <small class="text-muted">구글 디스커버 최적화 (1200x675)</small>
                    </div>
                    <div class="card-body">
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-images fa-3x text-muted mb-3"></i>
                            <p class="text-muted">이미지를 드래그 앤 드롭하거나 클릭하여 업로드<br>
                            <small>최대 4개까지, 자동으로 1200x675 크기로 최적화됩니다</small></p>
                            <input type="file" id="imageFiles" accept="image/*" multiple style="display: none;">
                            <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('imageFiles').click()">
                                파일 선택 (다중 선택 가능)
                            </button>
                        </div>
                        
                        <div id="uploadProgress" class="mt-3" style="display: none;">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                            </div>
                            <small class="text-muted mt-1 d-block" id="progressText">업로드 중...</small>
                        </div>
                        
                        <div id="imagePreviewContainer" class="mt-3" style="display: none;">
                            <h6>업로드된 이미지:</h6>
                            <div class="row" id="imagePreviewGrid">
                                <!-- 이미지 미리보기들이 여기에 추가됩니다 -->
                            </div>
                            <div class="mt-2">
                                <small class="text-muted">이미지 경로: </small>
                                <div id="imagePathsList" class="mt-1">
                                    <!-- 이미지 경로들이 여기에 표시됩니다 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 마크다운 에디터 -->
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-edit"></i> 기사 본문</h5>
                        <div class="btn-toolbar" role="toolbar">
                            <div class="btn-group btn-group-sm me-2" role="group">
                                <button type="button" class="btn btn-outline-secondary" onclick="insertText('**', '**')" title="굵게">
                                    <i class="fas fa-bold"></i>
                                </button>
                                <button type="button" class="btn btn-outline-secondary" onclick="insertText('*', '*')" title="기울임">
                                    <i class="fas fa-italic"></i>
                                </button>
                                <button type="button" class="btn btn-outline-secondary" onclick="insertText('[링크텍스트](', ')')" title="링크">
                                    <i class="fas fa-link"></i>
                                </button>
                            </div>
                            <div class="btn-group btn-group-sm" role="group">
                                <button type="button" class="btn btn-outline-secondary" onclick="insertText('## ', '')" title="제목">
                                    <i class="fas fa-heading"></i>
                                </button>
                                <button type="button" class="btn btn-outline-secondary" onclick="insertText('- ', '')" title="리스트">
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <textarea id="content" class="form-control border-0" rows="20" 
                                  placeholder="마크다운 형식으로 기사 본문을 작성하세요..."></textarea>
                    </div>
                </div>
            </div>

            <!-- 우측: 미리보기 -->
            <div class="col-lg-6">
                <div class="card sticky-top">
                    <div class="card-header">
                        <h5><i class="fas fa-eye"></i> 실시간 미리보기</h5>
                    </div>
                    <div class="card-body p-0">
                        <div id="preview" class="preview-content">
                            <div class="text-center text-muted p-5">
                                <i class="fas fa-eye fa-3x mb-3"></i>
                                <p>기사 정보를 입력하면 미리보기가 표시됩니다</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GitHub 업로드 모달 -->
    <div class="modal fade" id="githubModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">GitHub 업로드</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="githubToken" class="form-label">GitHub Personal Access Token</label>
                        <input type="password" class="form-control" id="githubToken" 
                               placeholder="ghp_...">
                        <div class="form-text">
                            <a href="https://github.com/settings/tokens" target="_blank">토큰 생성하기</a>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="repoUrl" class="form-label">레포지토리 URL</label>
                        <input type="text" class="form-control" id="repoUrl" 
                               value="gkstn15234/news" readonly>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" id="confirmUpload">업로드</button>
                </div>
            </div>
        </div>
    </div>

    <!-- AI 글작성 모달 -->
    <div class="modal fade" id="aiWriteModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-robot"></i> AI 글작성 도우미
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <strong>AI가 오토데일리 스타일로 기사를 작성해드립니다!</strong><br>
                        제목과 간단한 설명만 입력하면 정해진 양식에 맞춰 완성된 기사가 생성됩니다.
                    </div>
                    
                    <div class="mb-3">
                        <label for="aiTitle" class="form-label">기사 제목 *</label>
                        <input type="text" class="form-control" id="aiTitle" 
                               placeholder="예: 현대차 3분기 영업이익 2조 돌파">
                        <div class="form-text">AI가 이 제목을 기반으로 매력적인 기사를 작성합니다</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="aiDescription" class="form-label">기사 요약</label>
                        <textarea class="form-control" id="aiDescription" rows="3" 
                                  placeholder="기사의 핵심 내용을 간단히 요약해주세요 (선택사항)"></textarea>
                    </div>
                    
                    <div class="mb-3">
                        <label for="aiCategory" class="form-label">카테고리</label>
                        <select class="form-select" id="aiCategory">
                            <option value="auto">자동 분류</option>
                            <option value="automotive">자동차</option>
                            <option value="economy">경제</option>
                        </select>
                        <div class="form-text">AI가 내용을 분석하여 자동으로 분류합니다</div>
                    </div>

                    <div class="mb-3">
                        <label for="referenceContent" class="form-label">참고 자료 (선택사항)</label>
                        <textarea class="form-control" id="referenceContent" rows="4" 
                                  placeholder="참고할 뉴스 기사나 자료가 있다면 여기에 붙여넣기 하세요"></textarea>
                        <div class="form-text">참고 자료를 제공하면 더 정확하고 풍부한 내용으로 작성됩니다</div>
                    </div>
                    
                    <div id="aiProgress" class="mt-3" style="display: none;">
                        <div class="progress">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                 role="progressbar" style="width: 0%"></div>
                        </div>
                        <small class="text-muted mt-1 d-block" id="aiProgressText">AI가 기사를 작성 중입니다...</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" id="generateArticle">
                        <i class="fas fa-magic"></i> 기사 생성
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- OpenAI 설정 모달 -->
    <div class="modal fade" id="openaiModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-cog"></i> OpenAI API 설정
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>AI 글작성을 위해 OpenAI API 키가 필요합니다</strong>
                    </div>
                    
                    <div class="mb-3">
                        <label for="openaiApiKey" class="form-label">OpenAI API Key</label>
                        <input type="password" class="form-control" id="openaiApiKey" 
                               placeholder="sk-...">
                        <div class="form-text">
                            <a href="https://platform.openai.com/api-keys" target="_blank">
                                OpenAI API 키 생성하기
                            </a>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <small>
                            <strong>안전한 사용:</strong><br>
                            • API 키는 브라우저에만 임시 저장됩니다<br>
                            • 브라우저를 닫으면 자동으로 삭제됩니다<br>
                            • GPT-4o Mini 모델을 사용하여 비용을 최소화합니다
                        </small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                    <button type="button" class="btn btn-primary" id="saveOpenaiKey">
                        <i class="fas fa-save"></i> 저장
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@5.1.1/marked.min.js"></script>
    <script src="openai.js"></script>
    <script src="local-upload.js"></script>
    <script src="script.js"></script>
</body>
</html> 